webpackJsonp([23],{109:function(e,t,r){"use strict";function n(e,t,r,n){var i;return i={},i[o.a]={types:[s,r,c],endpoint:"cfProjectDynamic",json:!0,params:{ppid:e,page:t},showLoading:n},i}var o=r(4);r.d(t,"b",function(){return s}),r.d(t,"c",function(){return i}),r.d(t,"d",function(){return a}),r.d(t,"e",function(){return c});var s="CF_POSITION_HISTORY_REQUEST",i="CF_POSITION_HISTORY_SUCCESS_INIT",a="CF_POSITION_HISTORY_SUCCESS_NEXT",c="CF_POSITION_HISTORY_FAILURE";t.a=function(e,t,r,o){return function(s,c){return c().page.isProjectDynamicFetching?null:s(n(e,t,r?i:a,o))}}},14:function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=r(0),a=r.n(i),c=function(e){function t(){return n(this,t),o(this,e.apply(this,arguments))}return s(t,e),t.prototype.renderItems=function(){var e=this.props.items.map(this.props.itemRenderer),t=this.props.className;return this.props.itemsRenderer(e,{className:t})},t.prototype.render=function(){var e=this.props.items;return e&&0!==e.length?this.renderItems():null},t}(i.Component);c.displayName="List",c.propTypes={className:i.PropTypes.string,items:i.PropTypes.array.isRequired,itemRenderer:i.PropTypes.func,itemsRenderer:i.PropTypes.func},c.defaultProps={itemRenderer:function(e,t){return a.a.createElement("div",{key:t},e)},itemsRenderer:function(e,t){return a.a.createElement("div",t,e)}},t.a=c},29:function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){return e?(e.offsetTop||0)+i(e.offsetParent):0}var a=r(0),c=r.n(a),p=r(14),l=r(31),u=function(e){function t(){var r,s,a;n(this,t);for(var c=arguments.length,p=Array(c),l=0;l<c;l++)p[l]=arguments[l];return r=s=o(this,e.call.apply(e,[this].concat(p))),s.scrollListener=function(){var e=document.body.scrollTop||document.documentElement.scrollTop;i(s.el)+s.el.offsetHeight-e-window.innerHeight<250&&(s.detachScrollListener(),s.props.loadMore())},a=r,o(s,a)}return s(t,e),t.prototype.componentDidMount=function(){this.attachScrollListener()},t.prototype.componentDidUpdate=function(){this.attachScrollListener()},t.prototype.componentWillUnmount=function(){this.detachScrollListener()},t.prototype.attachScrollListener=function(){!this.props.hasMore||this.props.isFetching||this.props.error||(window.addEventListener("scroll",this.scrollListener),window.addEventListener("resize",this.scrollListener),this.scrollListener())},t.prototype.detachScrollListener=function(){window.removeEventListener("scroll",this.scrollListener),window.removeEventListener("resize",this.scrollListener)},t.prototype.render=function(){var e=this,t=this.props,r=t.className,n=t.items,o=t.itemRenderer,s=t.itemsRenderer,i=t.isFetching,a=t.hasMore,u=t.showEnd,f=t.error,h=t.loadMore,y={className:r,items:n,itemRenderer:o,itemsRenderer:s},d={isFetching:i,hasMore:a,showEnd:u,error:f,loadMore:h};return c.a.createElement("div",{ref:function(t){e.el=t}},c.a.createElement(p.a,y),c.a.createElement(l.a,d))},t}(a.Component);u.displayName="InfiniteList",u.propTypes={className:a.PropTypes.string,items:a.PropTypes.array.isRequired,itemRenderer:a.PropTypes.func,itemsRenderer:a.PropTypes.func,isFetching:a.PropTypes.bool,hasMore:a.PropTypes.bool,showEnd:a.PropTypes.bool,error:a.PropTypes.bool,loadMore:a.PropTypes.func.isRequired},u.defaultProps={showEnd:!0},t.a=u},31:function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=r(0),a=r.n(i),c=r(32),p=(r.n(c),function(e){function t(){var r,s,i;n(this,t);for(var a=arguments.length,c=Array(a),p=0;p<a;p++)c[p]=arguments[p];return r=s=o(this,e.call.apply(e,[this].concat(c))),s.retry=function(){s.props.loadMore&&s.props.loadMore()},i=r,o(s,i)}return s(t,e),t.prototype.render=function(){return this.props.isFetching?a.a.createElement("div",{className:"base-loading"},a.a.createElement("i",{className:"icon-loading"}),a.a.createElement("span",{className:"txt"},"加载中")):this.props.showEnd&&!this.props.hasMore?a.a.createElement("div",{className:"base-loading"},a.a.createElement("span",{className:"txt"},"没有更多结果了")):this.props.error?a.a.createElement("div",{className:"base-loading"},a.a.createElement("span",{className:"txt",onClick:this.retry},"加载失败，点击重试")):null},t}(i.Component));p.displayName="LoadStatus",p.propTypes={isFetching:i.PropTypes.bool,showEnd:i.PropTypes.bool,hasMore:i.PropTypes.bool,error:i.PropTypes.bool,loadMore:i.PropTypes.func},t.a=p},32:function(e,t){},381:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7),o=r(570),s=r(535),i=r.i(n.a)(o.a);i(s.a)},429:function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=r(0),a=r.n(i),c=r(1),p=r.n(c),l=r(29),u=r(620),f=(r.n(u),function(e){function t(){var r,s,i;n(this,t);for(var c=arguments.length,p=Array(c),l=0;l<c;l++)p[l]=arguments[l];return r=s=o(this,e.call.apply(e,[this].concat(p))),s.newsItemRender=function(e,t){return a.a.createElement("li",{className:0===t?"current":"",key:t,onClick:s.handleItemClick(e.newsId)},a.a.createElement("p",{className:"event"},e.title),a.a.createElement("p",{className:"time"},e.reportTime),a.a.createElement("div",{className:"icon"}),a.a.createElement("div",{className:"border"}))},s.loadMore=function(){s.props.loadPositionHistory(s.props.ppid,s.props.nextPage,!1,!1)},i=r,o(s,i)}return s(t,e),t.prototype.componentWillMount=function(){this.props.loadPositionHistory(this.props.ppid,1,!0,!0)},t.prototype.componentDidMount=function(){var e=this;p.a.ui.window.openDropDownRefresh(function(t){var r=e.props.loadPositionHistory(e.props.ppid,1,!0,!1);r?r.then(t).catch(t):t()})},t.prototype.newsItemsRender=function(e){return a.a.createElement("ul",null,e)},t.prototype.handleItemClick=function(e){return function(t){t.preventDefault(),p.a.navigator.discoverDetail(e)}},t.prototype.render=function(){return a.a.createElement("div",{className:"mod-zc-position"},a.a.createElement("div",{className:"zc-position-history"},a.a.createElement("div",{className:"process"},a.a.createElement("div",{className:"title"},a.a.createElement("i",null),"项目动态"),a.a.createElement(l.a,{items:this.props.newsList,itemsRenderer:this.newsItemsRender,itemRenderer:this.newsItemRender,showEnd:!0,isFetching:this.props.isFetching,hasMore:this.props.hasMore,error:this.props.isError,loadMore:this.loadMore}))))},t}(i.Component));f.displayName="CrowdFundingPositionHistory",f.propTypes={ppid:i.PropTypes.number,isFetching:i.PropTypes.bool,isError:i.PropTypes.bool,nextPage:i.PropTypes.number,newsList:i.PropTypes.arrayOf(i.PropTypes.shape({newsId:i.PropTypes.number,title:i.PropTypes.string,reportTime:i.PropTypes.string})),hasMore:i.PropTypes.bool,loadPositionHistory:i.PropTypes.func.isRequired},t.a=f},535:function(e,t,r){"use strict";function n(e){var t=parseInt(e.query.ppid,10),r=e.page,n=r.isProjectDynamicFetching,o=r.isProjectDynamicError,s=r.nextPage,i=r.newsList,a=r.hasMore;return{ppid:t,isFetching:n,isError:o,nextPage:s,newsList:i,hasMore:a}}var o=r(5),s=r(109),i=r(429);t.a=r.i(o.a)(n,{loadPositionHistory:s.a})(i.a)},570:function(e,t,r){"use strict";function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isProjectDynamicFetching:!1,isProjectDynamicError:!1,nextPage:1,newsList:[],hasMore:!0},t=arguments[1];switch(t.type){case a.b:return s()({},e,{isProjectDynamicFetching:!0,isProjectDynamicError:!1});case a.c:return s()({},e,{isProjectDynamicFetching:!1,isProjectDynamicError:!1,nextPage:2,newsList:t.response.result.newsList,hasMore:t.response.result.newsList.length<t.response.result.count});case a.d:return s()({},e,{isProjectDynamicFetching:!1,isProjectDynamicError:!1,nextPage:e.nextPage+1,newsList:[].concat(e.newsList,t.response.result.newsList),hasMore:e.newsList.length+t.response.result.newsList.length<t.response.result.count});case a.e:return s()({},e,{isProjectDynamicFetching:!1,isProjectDynamicError:!0});default:return e}}var o=r(2),s=r.n(o),i=r(6),a=r(109);t.a=r.i(i.a)(n)},620:function(e,t){},953:function(e,t,r){e.exports=r(381)}},[953]);
//# sourceMappingURL=positionHistory_28f841a5cf14d23ec809.js.map